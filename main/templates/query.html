<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Final Exam</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <style>
    body { background-color: #f8f9fa; }
    .correct { color: green; font-weight: bold; }
    .incorrect { color: red; font-weight: bold; }
    .tab-pane form { text-align: left; }
  </style>
</head>
<body>
  <div class="container my-5">
    <h2 class="text-center mb-4">Final Exam</h2>

    <ul class="nav nav-tabs mb-3" id="examTabs" role="tablist">
      <li class="nav-item" role="presentation">
        <button class="nav-link active" id="python-tab" data-bs-toggle="tab" data-bs-target="#python" type="button" role="tab">Python Exam</button>
      </li>
      <li class="nav-item" role="presentation">
        <button class="nav-link" id="cpp-tab" data-bs-toggle="tab" data-bs-target="#cpp" type="button" role="tab">C++ Exam</button>
      </li>
    </ul>
<ul class="nav nav-tabs mb-3" id="examTabs" role="tablist">
</ul>

<div id="timer" class="text-center mb-3 fw-bold" style="font-size:1.2rem;">
  Time left: 05:00
</div>

    {% if message %}
      <div class="alert alert-info">{{ message }}</div>
    {% endif %}

    <div class="tab-content" id="examTabContent">
      <div class="tab-pane fade show active" id="python" role="tabpanel">
        <form id="pythonForm" method="POST">
          <input type="hidden" name="pythonForm" value="1">
          
          <div class="mb-3">
            <label class="form-label fw-bold">1. Which phrase is used for printing in Python?</label>
            <select class="form-select" name="q1" required>
              <option value="" selected disabled>select</option>
              <option value="print">print()</option>
              <option value="echo">echo()</option>
              <option value="cout">cout</option>
            </select>
          </div>
          <div class="mb-3">
            <label class="form-label fw-bold">2. What is the integer data type in Python?</label>
            <select class="form-select" name="q2" required>
              <option value="" selected disabled>select</option>
              <option value="int">int</option>
              <option value="float">float</option>
              <option value="str">str</option>
            </select>
          </div>
          <div class="mb-3">
            <label class="form-label fw-bold">3. What is a repeat loop in Python?</label>
            <select class="form-select" name="q3" required>
              <option value="" selected disabled>select</option>
              <option value="for">for</option>
              <option value="while">while</option>
              <option value="do-while">do-while</option>
            </select>
          </div>
          <div class="mb-3">
            <label class="form-label fw-bold">4. Which of the following is used to create a function in python?</label>
            <select class="form-select" name="q4" required>
              <option value="" selected disabled>select</option>
              <option value="def">def</option>
              <option value="func">func</option>
              <option value="function">function</option>
            </select>
          </div>
          <div class="mb-3">
            <label class="form-label fw-bold">5. What will be the output of the following code?
            <pre>  
            x = [1, 2, 3]
            print(x[1])
            </pre>
            </label>
            <select class="form-select" name="q5" required>
              <option value="" selected disabled>select</option>
              <option value="1">1</option>
              <option value="2">2</option>
              <option value="3">3</option>
            </select>
          </div>
          <div class="mb-3">
            <label class="form-label fw-bold">6. What will be printed?
              <pre>
                print("5" * 3)
              </pre>
            </label>
            <select class="form-select" name="q6" required>
              <option value="" selected disabled>select</option>
              <option value="15">15</option>
              <option value="555">555</option>
              <option value="error">error</option>
            </select>
          </div>
          <div class="mb-3">
            <label class="form-label fw-bold">7. Which of the following statements is correct about lists and tuples in python?</label>
            <select class="form-select" name="q7" required>
              <option value="" selected disabled>select</option>
              <option value="Lists are immutable, tuples are mutable">Lists are immutable, tuples are mutable</option>
              <option value="Lists are mutable, tuples are immutable">Lists are mutable, tuples are immutable</option>
              <option value="Both lists and tuples are immutable">Both lists and tuples are immutable</option>
            </select>
          </div>
          <div class="mb-3">
            <label class="form-label fw-bold">8. What is the output?
              <pre>
                x = {"a": 1, "b": 2}
                print(x.get("c", 5))
              </pre>
            </label>
            <select class="form-select" name="q8" required>
              <option value="" selected disabled>select</option>
              <option value="none">None</option>
              <option value="5">5</option>
              <option value="error">Error</option>
            </select>
          </div>
          <div class="mb-3">
            <label class="form-label fw-bold">9. Which of these is the correct way to import only the 'sqrt' function from the 'math' module?</label>
            <select class="form-select" name="q9" required>
              <option value="" selected disabled>select</option>
              <option value="import sqrt from math">import sqrt from math</option>
              <option value="from math import sqrt">from math import sqrt</option>
              <option value="import math sqrt">import math sqrt</option>
            </select>
          </div>
          <div class="mb-3">
            <label class="form-label fw-bold">10. What will be the output?
              <pre>
                x = [1, 2, 3]
                y = x
                y.append(4)
                print(x)
              </pre>
            </label>
            <select class="form-select" name="q10" required>
              <option value="" selected disabled>select</option>
              <option value="3">[1, 2, 3]</option>
              <option value="4">[1, 2, 3, 4]</option>
              <option value="error">Error</option>
            </select>
          </div>
          <button type="submit" class="btn btn-primary">Submit Python Exam</button>
        </form>

        {% if results %}
          <ul class="list-group mt-3">
          {% for q,res in results.items() %}
            {% if res.is_correct %}
              <li class="list-group-item correct">
                Question {{ q[1:] }}: Your answer: {{ res.user }}, Correct answer: {{ res.correct }}
              </li>
            {% else %}
              <li class="list-group-item incorrect">
                Question {{ q[1:] }}: Your answer: {{ res.user }}, Correct answer: {{ res.correct }}
              </li>
            {% endif %}
          {% endfor %}
          </ul>
        {% endif %}
      </div>
    
      <div class="tab-pane fade" id="cpp" role="tabpanel">
        <form id="cppForm" method="POST">
          <input type="hidden" name="cppForm" value="1">

          <div class="mb-3">
            <label class="form-label fw-bold">1. What is the typography in C++?</label>
            <select class="form-select" name="q1" required>
              <option value="" selected disabled>select</option>
              <option value="cout">cout</option>
              <option value="print">print()</option>
              <option value="echo">echo()</option>
            </select>
          </div>
          <div class="mb-3">
            <label class="form-label fw-bold">2. How to define the correct variable in C++?</label>
            <select class="form-select" name="q2" required>
              <option value="" selected disabled>select</option>
              <option value="int x;">int x;</option>
              <option value="x int;">x int;</option>
              <option value="var x;">var x;</option>
            </select>
          </div>
          <div class="mb-3">
            <label class="form-label fw-bold">3. A loop that runs at least once?</label>
            <select class="form-select" name="q3" required>
              <option value="" selected disabled>select</option>
              <option value="do-while">do-while</option>
              <option value="while">while</option>
              <option value="for">for</option>
            </select>
          </div>
          <div class="mb-3">
            <label class="form-label fw-bold">4. Which keyword is used to define a constant variable?</label>
            <select class="form-select" name="q4" required>
              <option value="" selected disabled>select</option>
              <option value="constant">constant</option>
              <option value="final">final</option>
              <option value="const">const</option>
            </select>
          </div>
          <div class="mb-3">
            <label class="form-label fw-bold">5. What will this code print?
              <pre>
                int x = 10;
                if (x > 5)
                  cout << "A";
                else
                  cout << "B";
              </pre>
            </label>
            <select class="form-select" name="q5" required>
              <option value="" selected disabled>select</option>
              <option value="A">A</option>
              <option value="B">B</option>
              <option value="nothing">nothing</option>
            </select>
          </div>
          <div class="mb-3">
            <label class="form-label fw-bold">6. What will be the output?
              <pre>
                int arr[] = {1, 2, 3};
                cout << arr[1];
              </pre>
            </label>
            <select class="form-select" name="q6" required>
              <option value="" selected disabled>select</option>
              <option value="1">1</option>
              <option value="2">2</option>
              <option value="3">3</option>
            </select>
          </div>
          <div class="mb-3">
            <label class="form-label fw-bold">7. Which header file is needed for cout and cin?</label>
            <select class="form-select" name="q7" required>
              <option value="" selected disabled>select</option>
              <option value="iostream">iostream</option>
              <option value="stdio.h">stdio.h</option>
              <option value="string">string</option>
            </select>
          </div>
          <div class="mb-3">
            <label class="form-label fw-bold">8. What will be the output?
              <pre>
                int a = 5;
                int b = 2;
                cout << a / b;
              </pre>
            </label>
            <select class="form-select" name="q8" required>
              <option value="" selected disabled>select</option>
              <option value="2.5">2.5</option>
              <option value="2">2</option>
              <option value="error">Error</option>
            </select>
          </div>
          <div class="mb-3">
            <label class="form-label fw-bold">9. Which of the following is NOT a valid data type in C++?</label>
            <select class="form-select" name="q9" required>
              <option value="" selected disabled>select</option>
              <option value="float">float</option>
              <option value="char">char</option>
              <option value="real">real</option>
            </select>
          </div>
          <div class="mb-3">
            <label class="form-label fw-bold">10. What will be the output?
              <pre>
                int x = 5;
                int y = ++x;
                cout << y;
              </pre>
            </label>
            <select class="form-select" name="q10" required>
              <option value="" selected disabled>select</option>
              <option value="5">5</option>
              <option value="6">6</option>
              <option value="error">Error</option>
            </select>
          </div>
          <button type="submit" class="btn btn-primary">Submit C++ Exam</button>
        </form>

        {% if results %}
          <ul class="list-group mt-3">
          {% for q,res in results.items() %}
            {% if res.is_correct %}
              <li class="list-group-item correct">
                Question {{ q[1:] }}: Your answer: {{ res.user }}, Correct answer: {{ res.correct }}
              </li>
            {% else %}
              <li class="list-group-item incorrect">
                Question {{ q[1:] }}: Your answer: {{ res.user }}, Correct answer: {{ res.correct }}
              </li>
            {% endif %}
          {% endfor %}
          </ul>
        {% endif %}
      </div>
    </div>
  </div>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
  const totalTime = 300;
  let timeLeft = totalTime;
  let timerInterval = null;

  const timerElement = document.getElementById("timer");

  const pythonForm = document.getElementById("pythonForm");
  const cppForm = document.getElementById("cppForm");

  let currentForm = pythonForm;

  function updateTimer() {
    let minutes = Math.floor(timeLeft / 60).toString().padStart(2, "0");
    let seconds = (timeLeft % 60).toString().padStart(2, "0");
    timerElement.textContent = `Time left: ${minutes}:${seconds}`;
  }

  function finishForm(form) {
    if (!form) return;

    let answers = form.id === "pythonForm" ? pythonAnswers : cppAnswers;
    let score = 0;
    let total = Object.keys(answers).length;
    let resultHTML = "<ul class='list-group'>";

    for (const [q, correctAns] of Object.entries(answers)) {
      const userAns = form[q].value || "";
      if (userAns === correctAns) score++;
      resultHTML += `<li class="list-group-item ${userAns === correctAns ? "correct" : "incorrect"}">
                       Question ${q.slice(1)}: ${userAns === correctAns ? "correct" : "wrong. correct: " + correctAns}
                     </li>`;
    }
    resultHTML += "</ul>";
    resultHTML += `<p class="mt-3 fw-bold">Your score: ${score} / ${total}</p>`;

    const resultDiv = form.id === "pythonForm" ? document.getElementById("pythonResult") : document.getElementById("cppResult");
    resultDiv.innerHTML = resultHTML;

    form.querySelectorAll("select, button").forEach(el => el.disabled = true);

    fetch(window.location.pathname, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ formId: form.id, answers: answers })
    });
  }

  function startTimer() {
    clearInterval(timerInterval);
    timeLeft = totalTime;
    updateTimer();
    timerInterval = setInterval(() => {
      timeLeft--;
      updateTimer();
      if (timeLeft <= 0) {
        clearInterval(timerInterval);
        finishForm(currentForm);
        alert("Time is up! Your current answers have been submitted.");
      }
    },1000);
  }

  document.querySelectorAll('button[data-bs-toggle="tab"]').forEach(tab => {
    tab.addEventListener("shown.bs.tab", e => {
      currentForm = e.target.dataset.bsTarget === "#python" ? pythonForm : cppForm;
      startTimer();
    });
  });

  pythonForm.addEventListener("submit", e => {
    e.preventDefault();
    finishForm(pythonForm);
    clearInterval(timerInterval);
  });

  cppForm.addEventListener("submit", e => {
    e.preventDefault();
    finishForm(cppForm);
    clearInterval(timerInterval);
  });

  startTimer();
});

  </script>
</body>
</html>
